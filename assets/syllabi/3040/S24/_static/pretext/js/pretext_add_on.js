function getScrollbarWidth(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",e.appendChild(i);var n=i.offsetWidth;return e.parentNode.removeChild(e),t-n}function permalinkDescription(e){var t,i="",n=e.nodeName;e.classList.contains("para")&&(n="LI"==e.parentElement.nodeName?"LI":"P");var a,o=!1;"P"==n&&e.parentElement.parentElement.classList.contains("exercisegroup")&&(o=!0),a=o?e.parentElement.parentElement.querySelector(":scope > .heading"):"FIGCAPTION"==n?e:e.querySelector(":scope > .heading, :scope > figcaption, :scope > a > .heading");var s,r="",l=" ",c="";i="";if("P"==n)i=o?"Exercise Group":"Paragraph";else if("LI"==n)i="List item";else if(a)"ARTICLE"==n&&e.classList.contains("exercise")?i="Exercise":"ARTICLE"==n&&e.classList.contains("task")?(i=e.parentElement.firstElementChild.getAttribute("data-description"),l=""):(s=a.getElementsByClassName("type")).length>0&&(i=s[0].innerText);else{var d=e.className.split(" ")[0];i=d.charAt(0).toUpperCase()+d.slice(1)}i=i||"",a&&(i.length>0&&(s=a.getElementsByClassName("codenumber")).length>0&&(r=s[0].innerText),(s=a.getElementsByClassName("title")).length>0&&(c=s[0].innerText)),t=i,i.length>0&&r.length>0&&(t+=l+r),c.length>0&&(t.length>0?i!=c&&(t+=": "+c):t=c);var p=t.charAt(t.length-1);return"."!=p&&":"!=p||(t=t.slice(0,t.length-1)),t.replace(/[\n\r]/g,"")}async function copyPermalink(e){if(!navigator.clipboard)return;var t=e.querySelector(":scope > a");if(!t)return;const i=t.getAttribute("href"),n=e.getAttribute("data-description");var a='<a href="'+i+'">'+n+"</a>",o='<a class="internal" href="'+i+'">'+n+"</a>",s=n+" \r\n"+i,r=!0;try{await navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([a],{type:"text/html"}),"text/plain":new Blob([s],{type:"text/plain"})})])}catch(e){r=!1}if(!r)try{await navigator.clipboard.writeText(s)}catch(e){return}let l=document.createElement("p");l.setAttribute("role","alert"),l.className="permalink-alert",l.innerHTML="Link to "+o+" copied to clipboard",e.parentElement.insertBefore(l,e),await new Promise(e=>setTimeout(e,1500)),l.remove()}function updateURLParameter(e,t,i){var n="",a=e.split("?"),o=a[0],s=a[1],r="";if(s){a=s.split("&");for(var l=0;l<a.length;l++)a[l].split("=")[0]!=t&&(n+=r+a[l],r="&")}return o+"?"+n+(r+""+t+"="+i)}function WWiframeReseed(e,t){var i=document.getElementsByName(e)[0],n=i.src;void 0===t&&(t=Number(i.getAttribute("data-seed"))+80+84+88),i.setAttribute("data-seed",t),n=updateURLParameter(n,"problemSeed",t),i.src=n}function process_workspace(){MathJax.typesetPromise()}function pretext_geogebra_calculator_onload(){$("#calculator-toggle").focus();var e=$("input.gwt-SuggestBox.TextField")[0];e.focus()}function loadResource(e,t){var i,n,a;"undefined"==typeof js_version&&(js_version="0.2"),"undefined"==typeof css_version&&(css_version="0.6");var o="script";if("css"==e&&(o="link"),i=document.createElement(o),"css"==e)i.type="text/css",i.rel="stylesheet",i.href="https://pretextbook.org/css/"+css_version+"/"+t+".css",i.href+="?minivers="+minivers;else{if("js"!=e)return;i.type="text/javascript",i.src="https://pretextbook.org/js/"+js_version+"/"+t+".js",i.src+="?minivers="+minivers}(a=(n=document.getElementsByTagName(o))[n.length-1]).parentNode.insertBefore(i,a.nextSibling)}function scaleWorkspaceIn(e,t,i,n){these_workspaces=t.querySelectorAll(".workspace"),e!=t&&t.classList.contains("workspace")&&(these_workspaces=[t]);for(var a=0;a<these_workspaces.length;++a){if(this_work=these_workspaces[a],this_proportion=this_work.getAttribute("data-space"),this_proportion||(this_proportion="1.00"),this_proportion_number=parseFloat(this_proportion.slice(0,-2)),this_proportion.endsWith("in")?this_proportion_number*=10:this_proportion.endsWith("cm")?this_proportion_number*=3.94:this_proportion_number=40*this_proportion,this_proportion_scaled=i*this_proportion_number,this_work.setAttribute("style","height: "+this_proportion_scaled+"px"),"final"==n&&i<11?this_work.classList.add("squashed"):this_work.classList.remove("squashed"),"final"==n&&i>13){var o=12*this_proportion_number;this_work.style.background="linear-gradient( #eef 0px, #eef "+o+"px, #eef "+o+"px, #99f "+(o+5)+"px, #99f "+(o+5)+"px, #99f 100%)"}else this_work.style.background=null;if("final"==n){var s=this_work.parentElement.parentElement;"ARTICLE"==s.tagName&&(s=s.parentElement);var r=s.getBoundingClientRect().bottom;enclosingspacepadding=parseFloat(getComputedStyle(s)["padding-bottom"].slice(0,-2)),r-=enclosingspacepadding;var l=s.lastElementChild.getBoundingClientRect().bottom;r-l<5?this_work.classList.add("tight"):this_work.classList.remove("tight")}}return e.clientHeight}function adjustWorkspace(){$(".workspace").attr("contenteditable","true"),document.execCommand("defaultParagraphSeparator",!1,"br");var e,t,i,n=document.querySelectorAll("body .worksheet .onepage"),a=14,o=10,s="letter";document.body.classList.contains("a4")&&(s="a4");for(var r=[],l=0;l<n.length;l++)"a4"==s?r.push(1320):r.push(1243),i=n[l],0==l&&i.classList.add("firstpage"),l==n.length-1&&i.classList.add("lastpage");for(l=0;l<n.length;l++){var c=(i=n[l]).parentElement.getBoundingClientRect(),d=i.getBoundingClientRect(),p=0;i.classList.contains("firstpage")&&(p+=d.top-c.top),i.classList.contains("lastpage")&&(p+=c.bottom-d.bottom),r[l]-=p;var h=12;(e=scaleWorkspaceIn(i,i,a,"tmp"))!=(t=scaleWorkspaceIn(i,i,o,"tmp"))&&(h=(r[l]*(a-o)+o*e-a*t)/(e-t)),scaleWorkspaceIn(i,i,h,"final"),n[l].setAttribute("style","height: "+r[l].toString()+"px");for(var u=i.clientHeight,m=i.querySelectorAll(".squashed:not(.tight)"),_=0;_<m.length;++_){var g=m[_];e=scaleWorkspaceIn(i,g,12,"tmp"),scaleWorkspaceIn(i,g,e<=u?12:h,"final")}}}function urlattribute(){var e=window.location.hostname;document.body.setAttribute("data-urlstub",e)}var minivers="0";"undefined"!=typeof miniversion&&(minivers=miniversion.toString()),window.addEventListener("load",function(){$(".aside-like").click(function(){$(this).toggleClass("front")}),$(".aside-like a").click(function(){$(this).closest(".aside-like").toggleClass("front")}),$("a").each(function(){$(this).parents(".aside-like").length&&($(this).attr("addafter","#"+$(this).closest(".aside-like").attr("id")),$(this).closest(".aside-like").attr("tabindex","0"))}),$("body").on("click",".image-box > img:not(.draw_on_me):not(.mag_popup), .sbspanel > img:not(.draw_on_me):not(.mag_popup), figure > img:not(.draw_on_me):not(.mag_popup), figure > div > img:not(.draw_on_me):not(.mag_popup)",function(){var e=document.createElement("div");e.setAttribute("style","background:#fff;"),e.setAttribute("class","mag_popup_container"),e.innerHTML='<img src="'+$(this).attr("src")+'" style="width:100%" class="mag_popup"/>',place_to_put_big_img=$(this).parents(".image-box, .sbsrow, figure, li, .cols2 article:nth-of-type(2n)").last(),"ARTICLE"==place_to_put_big_img.prop("tagName")&&(place_to_put_big_img=place_to_put_big_img.prev().children().first()),$(e).insertBefore(place_to_put_big_img)}),$("body").on("click","img.mag_popup",function(){this.parentNode.remove()}),p_no_id=document.querySelectorAll(".main p:not([id])");for(var t=p_no_id.length-1;t>=0;--t)if(e=p_no_id[t],!e.hasAttribute("id")&&!e.classList.contains("watermark")&&(prev_p=$(e).prevAll("p"),0!=prev_p.length))for(var i=1,n=[e],a=0;a<prev_p.length;++a){if(this_previous=prev_p[a],this_previous.hasAttribute("id")){base_id=this_previous.id;for(var o=0;o<n.length;++o){++i;var s=base_id+"-part"+i.toString();n[o].setAttribute("id",s)}break}n.unshift(this_previous)}if(document.querySelector("body.standalone"));else{items_needing_permalinks=document.querySelectorAll("main section:not(.introduction), main section .para, main section p, main section article, main section > figure.table-like, main section > figure.figure-like > figcaption, main section  .exercisegroup article, main section  .exercisegroup, main section article.exercise, main section .discussion-like,  main section article.paragraphs > figure.table-like, main section article.paragraphs > figure.figure-like, section > details"),this_url=window.location.href.split("#")[0],permalink_word="&#x1F517;";for(a=0;a<items_needing_permalinks.length;a++){this_item=items_needing_permalinks[a];var r=this_item.id;if(!Boolean(this_item.closest(".parsons"))&&(!Boolean(this_item.closest("details"))&&!this_item.parentElement.classList.contains("lines")&&"inline"!=getComputedStyle(this_item).display)){try{if(this_item.closest(".hidden-content"))continue}catch{}if("FIGCAPTION"==this_item.tagName&&(r=this_item.parentElement.id),this_item.classList.contains("para")&&(""==this_item.id?(r=this_item.parentElement.id,"LI"==this_item.parentElement.parentElement.nodeName&&(r="")):"LI"==this_item.parentElement.nodeName&&(r="")),r){this_file_name=this_url.split("/").pop().split(".")[0],this_permalink_url=this_url,this_file_name!==r&&(this_permalink_url+="#"+r);const e=permalinkDescription(this_item);this_permalink_container=document.createElement("div"),this_permalink_container.setAttribute("class","autopermalink"),this_permalink_container.setAttribute("onclick","copyPermalink(this)"),this_permalink_container.setAttribute("data-description",e),this_permalink_container.innerHTML='<a href="'+this_permalink_url+'" title="Copy permalink for '+e+'">'+permalink_word+"</a>",this_item.insertAdjacentElement("afterbegin",this_permalink_container)}}}}$(".pretext-content .autopermalink a").on("click",function(e){e.preventDefault()}),$(".ptx-content .autopermalink a").on("click",function(e){e.preventDefault()}),all_iframes=document.querySelectorAll("body iframeXXXX");for(a=0;a<all_iframes.length;a++)if(this_item=all_iframes[a],this_item_src=this_item.src,this_item_src.includes("youtube")){if(this_item_id=this_item.id,this_item_width=this_item.width,this_item_height=this_item.height,this_item_height<150)continue;var l=document.createElement("div"),c=document.createElement("div");parent_tag=this_item.parentElement.tagName,"FIGURE"==parent_tag?c.setAttribute("class","videobig"):c.setAttribute("class","videobig nofigure"),c.setAttribute("video-id",this_item_id),c.setAttribute("data-width",this_item_width),c.setAttribute("data-height",this_item_height),c.innerHTML="fit width",this_item.insertAdjacentElement("beforebegin",l),this_item.insertAdjacentElement("beforebegin",c),this_item.insertAdjacentElement("beforebegin",l)}$(".videobig").click(function(){parent_video_id=this.getAttribute("video-id"),this_video=document.getElementById(parent_video_id),original_width=this.getAttribute("data-width"),original_height=this.getAttribute("data-height"),browser_width=$(window).width(),width_ratio=browser_width/original_width,this_video.setAttribute("width",width_ratio*original_width),this_video.setAttribute("height",width_ratio*original_height),this_video.setAttribute("style","position:relative; left:-260px; z-index:1000"),this.setAttribute("class","videosmall"),this.innerHTML="make small",$(".videosmall").click(function(){parent_video_id=this.getAttribute("video-id"),this_video=document.getElementById(parent_video_id),original_width=this.getAttribute("data-width"),original_height=this.getAttribute("data-height"),this_video.removeAttribute("style"),this_video.setAttribute("width",original_width),this_video.setAttribute("height",original_height),this.setAttribute("class","videobig"),this.innerHTML="fit width"})})},!1),window.addEventListener("load",function(){var e=getScrollbarWidth();navigator.userAgent.match(/Mozilla/i),calcoffsetR=5,calcoffsetB=5,$("body").on("mouseover","#geogebra-calculator canvas",function(){$("body").css("overflow","hidden"),$("html").css("margin-right","15px"),$("#calculator-container").css("right",(calcoffsetR+e).toString()+"px"),$("#calculator-container").css("bottom",(calcoffsetB+e).toString()+"px")}),$("body").on("mouseout","#geogebra-calculator canvas",function(){$("body").css("overflow","scroll"),$("html").css("margin-right","0"),$("#calculator-container").css("right",calcoffsetR.toString()+"px"),$("#calculator-container").css("bottom",calcoffsetB.toString()+"px")}),$("body").on("click","#calculator-toggle",function(){if("none"==$("#calculator-container").css("display"))if($("#calculator-container").css("display","block"),$("#calculator-toggle").addClass("open"),$("#calculator-toggle").attr("title","Hide calculator"),$("#calculator-toggle").attr("aria-expanded","true"),create_calc_script=document.getElementById("create_ggb_calc"),create_calc_script)pretext_geogebra_calculator_onload();else{var e=document.createElement("script");e.id="create_ggb_calc",e.innerHTML="ggbApp.inject('geogebra-calculator')",document.body.appendChild(e)}else $("#calculator-container").css("display","none"),$("#calculator-toggle").removeClass("open"),$("#calculator-toggle").attr("title","Show calculator"),$("#calculator-toggle").attr("aria-expanded","false")})}),window.addEventListener("load",function(){window.location.href.includes("/preview/")&&$("main p[id], main article[id], main li[id], main section[id], main a[data-knowl]").each(function(){var e=$(this).attr("id");e&&(e.length>3&&!e.includes("-part")&&!e.startsWith("fn-")||e.startsWith("p-"))&&$(this).addClass("newstuff")})}),window.addEventListener("load",function(){document.onkeyup=function(e){switch((e||window.event).keyCode){case 13:just_hit_escape=!1,$(document.activeElement).hasClass("aside-like")?$(document.activeElement).toggleClass("front"):$(document.activeElement).hasClass("workspace")&&process_workspace();case 27:var t=document.activeElement.closest(".sagecell_editor");if(t&&!just_hit_escape)just_hit_escape=!0,setTimeout(function(){just_hit_escape=!1},1e3);else{if(!(knowl_focus_stack.length>0))break;most_recently_opened=knowl_focus_stack.pop(),knowl_focus_stack_uid.pop(),most_recently_opened.focus()}}}},!1),window.addEventListener("load",function(){if("judson-AATA"==$("body").attr("id")&&"undefined"!=typeof eBookConfig&&eBookConfig.username){aa_id="run"+eBookConfig.username,ut_id=eBookConfig.username;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://pretextbook.org/js/0.13/trails.js";var t=document.getElementsByTagName("script"),i=t[t.length-1];i.parentNode.insertBefore(e,i.nextSibling),trail=!0}}),window.addEventListener("load",function(){var e=window.location.href;e=(e=e.replace(/(#|\?).*/,"")).replace(/html$/,"ptx"),"undefined"!=typeof sourceeditable&&fetch(e).then(function(e){return e.text()}).then(function(e){e.includes("404 Not")||(loadResource("css","features"),loadResource("css","edit"),loadResource("js","login"),loadResource("js","edit"))})}),window.addEventListener("load",function(){if($("body").hasClass("braillesample"))for(var e=0,t=$("[data-knowl]"),i=1;i<t.length;++i)$knowl=$(t[i]),$knowl.attr("data-knowl-uid")||($knowl.attr("data-knowl-uid",e),e++),knowl_click_handler($knowl)}),window.addEventListener("load",function(){if(window.location.hash.length){let a=window.location.hash.substring(1);var e=document.getElementById(a);if("ARTICLE"==e.tagName){var t=e.querySelector("a[data-knowl]");t&&t.parentElement==e&&t.click()}else if(e.hasAttribute("data-knowl"))e.click();else{var i=e.closest(".hidden-content");if(i){var n=i.id;document.querySelector('[data-refid="'+n+'"]').click()}}}}),window.addEventListener("load",function(){if(document.body.classList.contains("worksheet")){for(var e=document.querySelectorAll("article > a[data-knowl]"),t=0;t<e.length;++t)e[t].click();window.setTimeout(adjustWorkspace,1e3),window.setTimeout(urlattribute,1500)}});